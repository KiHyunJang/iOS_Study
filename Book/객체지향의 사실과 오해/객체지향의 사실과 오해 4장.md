# 객체지향의 사실과 오해 4
   
## 역할 책임 협력
객체의 모양을 만드는 것은 객체가 참여하는 협력이다. 어떤 협력에 참여하는지가 객체에 필요한 행동을 결정하고, 필요한 행동이 객체의 상태를 결정한다.   
개별적인 객체의 행동이나 상태가 아니라 객체들 간의 협력에 집중해라.   
   
협력의 본질을 요청과 응답이다.   
   
객체지향 개발에서 가장 중요한 능력은 능숙하게 소프트웨어 객체에 할당하는 것이다.   
책임을 어떻게 구현할 것인가 하는 문제는 객체와 책임이 제자리를 잡은 후에 고려해도 늦지 않다.   
객체외 책임이 이리저리 부유하는 상황에서 성급하게 구현에 뛰어드는 것은 변경에 취약하고 다양한 협력에 참여할 수 없는 비자율적인 객체를 낳게 된다.   
   
객체의 책임을 하는 것과 아는 것 두가지 범주로 분류된다.   
**하는것**   
객체를 생성하거나 계산하는 등의 스스로 하는 것   
다른 객체의 행동을 시작시키는 것   
다른 객체의 활동을 제어하고 조절하는 것   
   
**아는 것**   
개인적인 정보에 대해 아는 것   
관련된 객체에 관해 아는 것   
자신이 유도하거나 계산할 수 있는 것에 대해 아는 것   
   
책임은 객체의 외부에 제공해 줄 수 있는 정보(아는 것)와 외부에 제공해 줄 수 있는 서비스(하는 것)의 목록이다.   
따라서 객체는 공용 인터페이스를 구성한다.   
   
객체가 다른 객체에게 주어진 책임을 수행하도록 요청을 보내는 것을 메세지 전송이라고 한다. 따라서 두 객체간의 협력은 메세지를 통해 이루어진다.   
   
설계를 시작하는 초반에는 어떤 객체가 어떤 책임을 가지고 어떤 방식으로 서로 협력하는지에 대한 개요를 아는 것만으로 충분하다.   
   
역할은 협력에서 다른 객체로 대체 할 수 있다는 의미기도하다.   
역할을 대체하기 위해선 각 역할이 수신할 수 있는 메세지를 동일한 방식으로 이해해야한다.   
   
역할은 객체지향 설계의 단순성, 유연성, 재사용성을 뒷받침하는 핵심 개념이다.   
   
## 책임-주도 설계(Responsibility-Driven Design)
객체지향 설계의 핵심은 올바른 책임을 올바른 객체에게 할당하는 것이다.   
전체 개발 단계에 걸쳐 객체의 역할과 책임, 협력을 도드라지게 만드는 기법과 체계를 따르는 것이 중요하다.   
   
이처럼 책임 주도 설계에서는 시스템의 책임을 객체의 책임으로 변환하고, 각 객체가 책임을 수행하는 중에 필요한 정보나 서비스를 제공해줄 협력자를 찾아 해당 협력자에게 책임을 할당하는 순차적인 방식으로 객체들의 협력 공동체를 구축한다.   
   
객체지향 시스템을 설계하는 절차는 다음과 같다.   
1.시스템이 사용자에게 제공해야하는 기능인 시스템 책임을 파악한다.   
2.시스템 책임을 더 작은 책임으로 분할한다.   
3.분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.   
4.객체가 책임을 수행하는 중에 다른 객체의 도움이 필요한 경우 이름 책임질 적절한 객체 또는 역할을 찾는다.   
5.해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력한다.   
   
## 디자인 패턴 (Design Pattern)
책임 주도 설계의 결과를 표현하며, 패턴은 모범이 되는 설계이다.   
패턴은 반복해서 일어나는 특정한 상황에서 어떤 설계가 왜 더 효과적인지에 대한 이유를 설명한다.   
디자인 패턴은 공통으로 사용할 수 있는 역할, 책임, 협력의 템플릿이다.   
특정한 상황에 적용 가능한 디자인 패턴을 잘 알고 있다면 책임 주도 설계의 절차를 순차적으로 따르지 않고도 시스템 안에 구현할 객체들의 역할, 책임, 협력 관계를 빠르게 포착할 수 있을 것이다.   
   
## 테스트 주도 개발 (Test-Driven Development)
테스트 주도 개발의 기본 흐름은 실패하는 테스트를 작성하고, 테스트를 통과하는 가장 간단한 코드를 작성한 후, 리팩토링을 통해 중복을 제거한다.   
테스트 주도 개발은 객체가 이미 존재한다고 가정하고 객체가 어떤 메세지를 전송할 것인지에 대해 먼저 생각하라고 충고한다.   
하지만 역할, 책임, 협력 관점에서 객체를 바라보지않을 경우 이 충고는 무의미하다.   
테스트 주도 개발은 테스트를 작성하는 것이 아니라 책임을 수행할 객체 또는 클라이언트가 기대하는 객체의 역할이 메세지를 수신할 때 어떤결과를 반환하고 그 과정에서 어떤 객체와 협력할 것인가에 대한 기대를 코드의 형태로 만드는 것이다.   
테스트를 작성하기 위해 객체의 메서드를 호출하고 반환값을 검증하는 것은 순간적으로 객체가 수행해야하는 책임에 관해 생각한 것이다.   
테스트에 필요한 간접 입력 값을 제공하기 위해 stub을 추가하거나 간접 출력 값을 위해 mock object를 사용하는 것은 객체와 협력해야 하는 협력자에 관해 고민한 결과를 코드로 표현한 것이다.   

